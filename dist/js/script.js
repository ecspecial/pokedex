let pokemonRepository=function(){let e=[],t=0,n=`https://pokeapi.co/api/v2/pokemon?offset=${t}&limit=30`;function i(t){"object"==typeof t&&"name"in t?e.push(t):console.log("Error! Wrong Pokemon format.")}function a(){return e}function o(e){let t=document.querySelector(".list");document.getElementById("search").addEventListener("keyup",c);let n=document.createElement("li"),i=document.createElement("div");i.classList.add("card"),i.id=`${e.name}-card`;let a=document.createElement("img","card-img"),o=document.createElement("div");o.classList.add("loader");let r=document.createElement("button");r.innerText=e.name,r.classList.add("button"),r.classList.add("btn"),r.classList.add("btn-primary"),r.setAttribute("data-toggle","modal"),r.setAttribute("data-target","#exampleModal"),i.appendChild(o),i.appendChild(a),i.appendChild(r),n.appendChild(i),t.appendChild(n),r.addEventListener("click",function(){s(e)})}function r(){return fetch(n).then(function(e){return e.json()}).then(function(e){e.results.forEach(function(e){i({name:e.name.charAt(0).toUpperCase()+e.name.slice(1),detailsUrl:e.url})})}).catch(function(e){console.error(e)})}function l(e){return fetch(e.detailsUrl).then(function(e){return e.json()}).then(function(t){let n=document.querySelector(`#${e.name}-card img`),i=document.querySelector(`#${e.name}-card .loader`);n.src=t.sprites.front_default,n.onload=function(){i.remove()}})}function s(e){pokemonRepository.loadDetails(e).then(function(){var t;let n,i,a,o,r,l,s,c,d;t=e,n=document.querySelector(".modal-body"),i=document.querySelector(".modal-title"),i.innerText="",n.innerText="",a=document.createElement("h1"),a.innerText=t.name,o=document.createElement("p"),o.innerText="Height: "+t.height,r=document.createElement("p"),r.innerText="Weight: "+t.weight,l=document.createElement("p"),l.innerText="Types: "+t.types,s=document.createElement("p"),s.innerText="Abilities: "+t.abilities,c=document.createElement("img"),c.classList.add("modal-img"),c.style.width="50%",c.src=t.imageUrlFront,d=document.createElement("img"),d.classList.add("modal-img"),d.style.width="30%",d.src=t.imageUrlBack,i.appendChild(a),n.appendChild(c),n.appendChild(d),n.appendChild(o),n.appendChild(r),n.appendChild(l),n.appendChild(s)})}function c(){var t;let n=document.getElementById("search").value.toLowerCase();t=e.filter(e=>e.name.toLowerCase().startsWith(n)),document.querySelector(".list").innerHTML="",t.forEach(e=>{pokemonRepository.getImage(e),pokemonRepository.addListItem(e)})}let d=!1;async function p(){d||(d=!0,t+=30,n=`https://pokeapi.co/api/v2/pokemon?offset=${t}&limit=30`,await r().then(function(){e.slice(t).forEach(function(e){l(e),o(e)})}),d=!1)}return{add:i,getAll:a,addListItem:o,loadList:r,loadDetails:function e(t){return fetch(t.detailsUrl).then(function(e){return e.json()}).then(function(e){t.imageUrlFront=e.sprites.front_default,t.imageUrlBack=e.sprites.back_default,t.height=e.height,t.weight=e.weight,t.types=[];for(var n=0;n<e.types.length;n++)t.types.push(e.types[n].type.name);t.abilities=[];for(var i=0;i<e.abilities.length;i++)t.abilities.push(e.abilities[i].ability.name)}).catch(function(e){console.error(e)})},showDeatails:s,getImage:l,fetchMorePokemons:p}}();!async function(){await pokemonRepository.loadList(),await pokemonRepository.getAll().forEach(function(e){pokemonRepository.getImage(e),pokemonRepository.addListItem(e)}),window.addEventListener("scroll",function(){window.innerHeight+window.scrollY>=document.body.offsetHeight&&pokemonRepository.fetchMorePokemons()})}();
